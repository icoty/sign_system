**综合实践报告**

李家东

----
概览<br>

本次综合实践项目是开发一个具有一下基本功能的签到系统：
1.为学生用户提供扫码签到功能，为活动管理员提供活动管理功能。
2.更具体的，对学生来说，需要具有活动查看、活动签到功能。
3.对活动管理员来说，需要具有活动发起功能、签到二维码生成功能、活动统计功能。
根据需求，项目的特点是功能主要集中在后端，前端用于展示。

目录<br>一、框架<br>二、数据导入导出功能<br>三、发起签到功能<br>

----
一、ThinkPHP框架<br>为什么选择ThinkPHP框架？

ThinkPHP的代码非常简洁，基本上对于拥有入门级别的php开发都能看得懂。 改起来相对方便。在业务开发过程中，PHP中的某些地方并不能完全满足项目开发的需求，因此在参照内部系统的基础上对框架代码进行了补充修改比较方便。

二、数据导入导出功能<br>根据需求，我们需要一个将活动数据表导入导出的功能，管理员可以通过数据导入功能导入历史签到数据，以及活动人员名单；通过导出功能拿到活动数据文件，进行下一步工作。

1.数据导入功能<br>

需要将数据导出为Excel表格文件，所以采用了比较常用的方法，基于PHPExcel核心类进行开发。
首先是在管理界面进行Excel文件的上传，然后在对应的php文件进行文件的处理，包括对文件按类型的判别、上传文件的命名，然后将Excel数据转化为数组，再写入到数据库中。数据导入功能基本完成。

2.数据导出功能<br>
数据导出主要分成两步：第一步是在数据库中查询，查找出需要导出的数据部分，第二步就是将查询到的数据导出，需要的功能包括数据格式的转换、导出文件名的生成、表头的设计。

![avatar][image-1]

三、发起签到功能<br>
发起签到需求是通过发起签到可以生成签到二维码，然后将合格二维码导出，学生通过扫码进行签到。签到的事件为单个活动。
首先是活动逻辑部分会生成签到链接，因为签到链接和活动ID唯一关联，因此可以采用与活动ID的映射作为链接的区分项。
前期进行了调研，了解到一些常规的生成二维码的方法，包括用JS原生实现二维码的功能，js的QRCode插件，以及第三方提供的二维码快速生成服务。经过分析，第三方提供的服务适合批量生成超多二维码，我们项目每次只需要生成一个二维码，不要同时大量生成，所以不用此方法。
因为使用了php框架，所以就放弃在用js去生成的方法，选择了phpqrcode框架，在上面进行更改和适应。选择phpqrcode的另外一个原因是他的稳定性比较好，很契合我们的需求。在开启GD2扩展后，将生成的活动签到页面的地址传进来，然后通过phpqrcode生成二维码图片，直接展示在网页，同时可以下载。我们的项目照顾你因为签到的时间是一个比较关键的点，因此发起签到，设置签到时间是一个必须选项。起始时间就是二维码的存活时间。
![avatar][image-2]

![avatar][image-3]

![avatar][image-4]

[image-1]:	./image/4.png
[image-2]:	./image/1.png
[image-3]:	./image/2.png
[image-4]:	./image/3.png

